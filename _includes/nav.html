<nav id="mainNav" class="navbar navbar-default navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand page-scroll" href="#page-top">
                <img
                    id="nav-logo"
                    src="{{ site.url }}{{ site.baseurl }}{{ site.data.content[page.lang].nav-image-dark }}"
                    data-img-light="{{ site.url }}{{ site.baseurl }}{{ site.data.content[page.lang].nav-image-light }}"
                    data-img-dark="{{ site.url }}{{ site.baseurl }}{{ site.data.content[page.lang].nav-image-dark }}"
                    style="object-fit: contain; height: 3em; padding-bottom: 1.5em; position: relative;">
            </a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <!-- Language switcher - now part of the main navbar -->
            <ul class="nav navbar-nav navbar-left">
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
                        {{ current_lang | upcase }} <span class="caret"></span>
                    </a>
                    <ul class="dropdown-menu">
                        {% assign current_lang = page.lang | default: 'en' %}
                        {% assign available_langs = "en,fr,de" | split: "," %}
                        
                        {% for lang in available_langs %}
                            {% if site.data.content[lang] %}
                                <li>
                                    <a href="{{ lang | prepend: '/' | prepend: site.baseurl | prepend: site.url }}" class="{% if current_lang == lang %}active{% endif %}" data-lang="{{ lang }}">
                                        {{ lang | upcase }}
                                    </a>
                                </li>
                            {% endif %}
                        {% endfor %}
                    </ul>
                </li>
            </ul>

            <!-- Main navigation -->
            <ul class="nav navbar-nav navbar-right">
                {% if site.data.content[page.lang].nav %}
                    {% for item in site.data.content[page.lang].nav %}
                        <li>
                            <a class="page-scroll" href="#{{ item.url }}">{{ item.title }}</a>
                        </li>
                    {% endfor %}
                {% endif %}
            </ul>
        </div><!-- /.navbar-collapse -->
    </div><!-- /.container-fluid -->

    <script>
        window.onscroll = function changeNavImage() {
            const navLogo = document.getElementById("nav-logo");
            const imgLight = navLogo.getAttribute("data-img-light");
            const imgDark = navLogo.getAttribute("data-img-dark");

            if (window.scrollY >= 100) {
                navLogo.src = imgLight;
            } else {
                navLogo.src = imgDark;
            }
        }
    </script>
</nav>